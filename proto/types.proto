syntax = "proto3";

package fax.compiler;

import "common.proto";

// Primitive types
enum PrimitiveType {
  TYPE_UNIT = 0;
  TYPE_I8 = 1;
  TYPE_I16 = 2;
  TYPE_I32 = 3;
  TYPE_I64 = 4;
  TYPE_U8 = 5;
  TYPE_U16 = 6;
  TYPE_U32 = 7;
  TYPE_U64 = 8;
  TYPE_F32 = 9;
  TYPE_F64 = 10;
  TYPE_BOOL = 11;
  TYPE_CHAR = 12;
  TYPE_STRING = 13;
  TYPE_INFERRED = 255;
}

// Type representation
message Type {
  oneof type_kind {
    PrimitiveType primitive = 1;
    ArrayType array = 2;
    TupleType tuple = 3;
    StructType struct = 4;
    EnumType enum = 5;
    FunctionType function = 6;
    NamedType named = 7;
  }
}

message ArrayType {
  Type element_type = 1;
  uint64 size = 2;
}

message TupleType {
  repeated Type elements = 1;
}

message StructType {
  string name = 1;
  repeated Field fields = 2;
}

message EnumType {
  string name = 1;
  repeated Variant variants = 2;
}

message Field {
  string name = 1;
  Type field_type = 2;
}

message Variant {
  string name = 1;
  repeated Type payload_types = 2;
}

message FunctionType {
  repeated Type param_types = 1;
  Type return_type = 2;
}

message NamedType {
  string name = 1;
}
